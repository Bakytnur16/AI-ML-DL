# AI

## GAN - ç”Ÿæˆå¼å¯¹æŠ—ç½‘ç»œ generative adversarial network
> æœ‰ä¸€ä¸ªã€ç”»æ‰‹ã€‘æƒ³è¦ä¼ªé€ åç”»å¤§å¸ˆçš„çœŸè¿¹å»éª—é’±ã€‚ä½†å³ä½¿ä¸æ–­åœ°ç»ƒä¹ ç»˜ç”»ï¼Œä»–çš„ç”»è¿˜æ˜¯èƒ½çœ‹å‡ºæ˜¯å‡çš„ã€‚äºæ˜¯ï¼Œä»–æ‰¾åˆ°ä¸€ä¸ªã€è‰ºæœ¯é‰´èµä¸“å®¶ã€‘æ£€æŸ¥ä»–çš„ä½œå“ï¼Œå‘Šè¯‰ä»–ä»å“ªé‡Œçœ‹å‡ºè¿™å¹…ç”»æ˜¯èµå“ã€‚äºæ˜¯ï¼Œé€šè¿‡ä¸æ–­çš„çŠ¯é”™å’Œç»˜ç”»ï¼Œç›´åˆ°å¤§å¸ˆä¹Ÿæ— æ³•åˆ¤æ–­ç”»æ‰‹çš„ä½œå“æ˜¯å¦æ˜¯èµå“åï¼Œç”»æ‰‹æˆä¸ºäº†æœ‰é’±äºº
- GAN æœ‰ 2 ä¸ªéƒ¨åˆ†ï¼Œå³ç”Ÿæˆå™¨ç½‘ç»œå’Œåˆ¤åˆ«å™¨ç½‘ç»œï¼Œå®ƒä»¬ååŒå·¥ä½œä»¥äº§ç”Ÿä¸çœŸå®å†…å®¹é›·åŒçš„è¾“å‡º   
- ã€ç”»æ‰‹ã€‘ - ç”Ÿæˆå™¨ç½‘ç»œï¼ˆgenerator networkï¼‰ï¼šè´Ÿè´£ä»ä»»æ„è¾“å…¥å¼€å§‹ç”Ÿæˆé€¼çœŸçš„å›¾åƒ
- ã€è‰ºæœ¯ä¸“å®¶ã€‘- åˆ¤åˆ«å™¨ç½‘ç»œ(discriminator network):åˆ¤æ–­ç»™å®šçš„å›¾åƒæ˜¯ç”±ç”Ÿæˆå™¨ç”Ÿæˆçš„è¿˜æ˜¯ä¸€å¹…çœŸå®çš„å›¾åƒ
- ç»˜ç”»åˆ›ä½œå’Œæ£€æµ‹èµå“äº’ç›¸ *â€œå¯¹æŠ—â€* ã€‚
> å¯¹æŠ—ï¼ˆadversarialï¼‰æ„å‘³ç€è¿™ 2 ä¸ªç½‘ç»œåœ¨ç«äº‰ï¼Œå…¶ä¸­ä¸€ä¸ªè¦æ¯”å¦ä¸€ä¸ªæ›´èªæ˜ï¼Œè€Œç½‘ç»œæ„ä¹‰å°±æ˜¾è€Œæ˜“è§äº†  
- ç”Ÿæˆå™¨çš„æœ€ç»ˆç›®æ ‡æ˜¯æ¬ºéª—åˆ¤åˆ«å™¨ï¼Œæ··æ·†çœŸä¼ªå›¾åƒ  
- åˆ¤åˆ«å™¨çš„æœ€ç»ˆç›®æ ‡æ˜¯å‘ç°å®ƒä½•æ—¶è¢«æ¬ºéª—äº†ï¼ŒåŒæ—¶å‘ŠçŸ¥ç”Ÿæˆå™¨åœ¨ç”Ÿæˆå›¾åƒä¸­å¯è¯†åˆ«çš„é”™è¯¯ã€‚  
- 2 ä¸ªç½‘ç»œéƒ½æ˜¯åŸºäºå½¼æ­¤ç½‘ç»œçš„ç»“æœè¿›è¡Œè®­ç»ƒçš„ï¼Œå¹¶æ¨åŠ¨å½¼æ­¤å¯¹ç½‘ç»œå‚æ•°è¿›è¡Œä¼˜åŒ–  

> ç”Ÿæˆå™¨è´Ÿè´£ä»ä»»æ„è¾“å…¥å¼€å§‹ç”Ÿæˆä¸ç›®æ ‡è¿‘ä¼¼çš„ç»“æœï¼Œç”±åˆ¤åˆ«å™¨åˆ¤æ–­ç”Ÿæˆçš„æ•°æ®ä¸ç›®æ ‡æ˜¯å¦ä¸€è‡´ã€‚éšç€è®­ç»ƒçš„æ¨è¿›ï¼Œä¿¡æ¯ä»åˆ¤åˆ«å™¨è¿”å›ï¼Œè€Œç”Ÿæˆå™¨ä½¿ç”¨è¿™äº›ä¿¡æ¯è¿›è¡Œæ”¹è¿›ã€‚åœ¨è®­ç»ƒç»“æŸæ—¶ï¼Œç”Ÿæˆå™¨å¯ä»¥ç”Ÿæˆä»¥å‡ä¹±çœŸçš„å›¾åƒäº†ï¼Œè€Œåˆ¤åˆ«å™¨å´ä¸å†èƒ½å¤Ÿè¯†åˆ«å‡ºå›¾åƒçš„çœŸä¼ªäº†

![image](https://user-images.githubusercontent.com/64322636/219339856-990f8b97-48c3-410d-92ff-1a57d011a7f6.png)
- åˆ¤åˆ«å™¨ä¸ç”Ÿæˆå™¨ä¹‹é—´è°è·èƒœå…¶å®æ²¡æœ‰æ„ä¹‰

## CycleGanå¾ªç¯ç”Ÿæˆå¼å¯¹æŠ—ç½‘ç»œã€ç¨³å®šã€‘
- CycleGANä½¿ç”¨ä¸€ç§æ”¯æŒåœ¨2ç§ä¸åŒç±»å‹çš„å›¾åƒä¹‹é—´æ¥å›è½¬æ¢çš„æ¶æ„   
> å¯ä»¥å°†ä¸€ä¸ªé¢†åŸŸçš„å›¾åƒè½¬æ¢ä¸ºå¦ä¸€ä¸ªé¢†åŸŸçš„å›¾åƒï¼Œè€Œä¸éœ€è¦æˆ‘ä»¬åœ¨è®­ç»ƒé›†ä¸­æ˜¾å¼åœ°æä¾›åŒ¹é…å¯¹ 
- ä¸€ä¸ªç»è¿‡è®­ç»ƒå¯ä»¥æ¬ºéª— 2 ä¸ªåˆ¤åˆ«å™¨ç½‘ç»œçš„CycleG  
- æ¯”å¦‚æŠŠæ–‘é©¬è½¬æ¢ä¸ºé©¬ã€æ–‘é©¬ğŸ¦“ -> æ£•é©¬ğŸã€‘  
![image](https://user-images.githubusercontent.com/64322636/219341287-3bcf77de-37ea-4871-a12b-89fed2d196a3.png)
- ç¬¬ 1 ä¸ªç”Ÿæˆå™¨: å­¦ä¹ ä»å±äºä¸åŒåˆ†å¸ƒåŸŸçš„å›¾åƒï¼ˆæœ¬ä¾‹æ˜¯é©¬ï¼‰ï¼Œç”Ÿæˆç¬¦åˆç›®æ ‡åŸŸçš„å›¾åƒï¼ˆæœ¬ä¾‹æ˜¯æ–‘é©¬ï¼‰ã€‚
- å› æ­¤åˆ¤åˆ«å™¨æ— æ³•åˆ†è¾¨å‡ºä»é©¬çš„ç…§ç‰‡ä¸­äº§ç”Ÿçš„å›¾åƒæ˜¯å¦çœŸçš„æ˜¯æ–‘é©¬çš„å›¾åƒ
- äº§ç”Ÿçš„å‡æ–‘é©¬å›¾åƒé€šè¿‡å¦ä¸€ä¸ªç”Ÿæˆå™¨å‘é€åˆ°å¦ä¸€ä¸ªåˆ¤åˆ«å™¨ï¼Œç”±å¦ä¸€ä¸ªåˆ¤åˆ«å™¨æ¥åˆ¤åˆ«

#### æ·±åº¦ä¼ªé€ 
- é¢éƒ¨äº¤æ¢æŠ€æœ¯

## torch
> pytorchæ˜¯ä¸€ä¸ªpythonç¼–æˆåº“ï¼Œæœ‰åŠ©äºæ„å»ºæ·±åº¦å­¦ä¹ é¡¹ç›®ï¼ˆæ·±åº¦å­¦ä¹ åº“)  
> PyTorch åº“å…è®¸ä½ é«˜æ•ˆåœ°æ„å»ºå’Œè®­ç»ƒç¥ç»ç½‘ç»œæ¨¡å‹  
> pytorchä¸ºäº†æ€§èƒ½æ˜¯ç”¨c++å’Œcudaç¼–å†™çš„  
> **TorchScript** å…è®¸æˆ‘ä»¬é¢„ç¼–è¯‘æ¨¡å‹ï¼Œå¹¶ä¸”ä¸ä»…å¯ä»¥åœ¨ Python ç¯å¢ƒä¸­è°ƒç”¨å®ƒä»¬ï¼Œè¿˜å¯ä»¥åœ¨C++ç¨‹åºå’Œç§»åŠ¨è®¾å¤‡ä¸Šè°ƒç”¨å®ƒä»¬  
> windowsé€šè¿‡anacondaæˆ–è€…minicondaå®‰è£…  
  
>**cuda**ï¼šè‹±ä¼Ÿè¾¾çš„ç±»c++è¯­è¨€ï¼Œè¢«ç¼–è¯‘å¹¶åœ¨GPUä¸Šå¹¶è¡Œæ–¹å¼è¿è¡Œ  

ä¼˜ç‚¹ï¼š
- çµæ´»æ€§ã€æ˜“ç”¨æ€§  
- ä½¿ç”¨GPUåŠ é€Ÿè®¡ç®—ï¼Œæ¯”CPUä¸Šæ‰§è¡Œç›¸åŒçš„è®¡ç®—é€Ÿåº¦å¿«50å€  

Theanoæœ€æ—©çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ä¹‹ä¸€ï¼Œä½†å·²åœæ­¢å¼€å‘

å·¥å…·åŒ…ï¼š
- torch.nn æä¾›äº†é€šç”¨ç¥ç»ç½‘ç»œå±‚å’Œå…¶ä»–æ¶æ„ç»„ä»¶ï¼ˆæ¿€æ´»ã€æŸå¤±å‡½æ•°ï¼‰
- torch.optim ä¼˜åŒ–å™¨
- torch.Tensor å¼ é‡  
å›¾ç‰‡ç”±RGBé€šé“ã€ç©ºé—´å›¾åƒç»´åº¦ï¼ˆé«˜åº¦ã€å®½åº¦ï¼‰ç»„æˆ

### Torch Hubæœºåˆ¶
- å¯ä»¥åœ¨Githubä¸Šå‘å¸ƒæ¨¡å‹
- æ— è®ºæ˜¯å¦é¢„å…ˆè®­ç»ƒè¿‡æƒé‡ï¼Œéƒ½å¯ä»¥é€šè¿‡ PyTorch å¯ä»¥ç†è§£çš„æ¥å£å°†å…¶å…¬å¼€å‘å¸ƒ    
- ä½¿ç”¨ Torch Hub é€šè¿‡é€‚å½“çš„ hubconf.py æ–‡ä»¶ä»å…¶ä»–ä»»ä½•é¡¹ç›®åŠ è½½æ¨¡å‹å’Œæƒé‡æ˜¯ä¸€ç§æ ‡å‡†åŒ–æ“ä½œæ–¹æ³•  
ä»Githubä¸ŠåŠ è‡ªé¢„è®­ç»ƒæ¨¡å‹ï¼š
> 1. æ‰¾åˆ°hubconf.py  
```
dependencies = ['torch', 'math'] #ä»£ç æ‰€ä¾èµ–çš„å¯é€‰æ¨¡å‹å—åˆ—è¡¨

def some_entry_fn(*args, **kwargs): 
 model = build_some_model(*args, **kwargs) 
 return model 

def another_entry_fn(*args, **kwargs): 
 model = build_another_model(*args, **kwargs) 
 return model 
#ä½œä¸ºå­˜å‚¨åº“å…¥å£ç‚¹å‘ç”¨æˆ·æš´éœ²ä¸€ä¸ªæˆ–å¤šä¸ªå‡½æ•°ã€‚è¿™äº›å‡½æ•°åº”è¯¥æ ¹æ®æ¨¡å‹åˆå§‹åŒ–å‚æ•°å¹¶å°†å…¶è¿”å›
```
> 2.pytorch/vision ä¸»åˆ†æ”¯çš„å¿«ç…§åŠå…¶æƒé‡ä¸‹è½½åˆ°æœ¬åœ°ç›®å½•  
> 3.é»˜è®¤ä¸‹è½½åˆ°æœ¬åœ°çš„ torch/hub ç›®å½•ä¸‹  
> 4.ç„¶åè¿è¡Œ resnet18 å…¥å£ç‚¹å‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›å®ä¾‹åŒ–çš„æ¨¡å‹  
```
import torch
from torch import hub

resnet18_model = hub.load('pytorch/vision:master','resnet18',pretrained=True)
#GitHub å­˜å‚¨åº“çš„åç§°å’Œåˆ†æ”¯ã€å‡½æ•°åç§°ã€å…³é”®å‚æ•°)
```

### HDF5 æ ¼å¼å’Œ h5py åº“
- HDF5 æ˜¯ä¸€ç§å¯ç§»æ¤çš„ã€è¢«å¹¿æ³›æ”¯æŒçš„æ ¼å¼ï¼Œç”¨äºå°†åºåˆ—åŒ–çš„å¤šç»´æ•°ç»„ç»„ç»‡åœ¨ä¸€ä¸ªåµŒå¥—çš„é”®å€¼å¯¹å­—å…¸ä¸­
- Python é€šè¿‡ h5py åº“æ”¯æŒ HDF5ï¼Œè¯¥åº“æ¥æ”¶å’Œè¿”å› NumPy æ•°ç»„æ ¼å¼çš„æ•°æ®  
<code>$ conda install h5py</code>
- å¼ é‡è½¬æ¢ä¸ºnpæ•°ç»„ï¼Œä¼ é€’ç»™create_dataset()
```
import h5py 
f = h5py.File('../data/p1ch3/ourpoints.hdf5', 'w') 
dset = f.create_dataset('coords',data=points.numpy()) 
f.close() 
```
- åŠ è½½æ•°æ®é›†çš„æœ€åä¸¤ä¸ªç‚¹ï¼š
```
# In[62]: 
f = h5py.File('../data/p1ch3/ourpoints.hdf5', 'r') 
dset = f['coords'] 
last_points = dset[-2:]
```
- ä¸€æ—¦å®Œæˆæ•°æ®åŠ è½½ï¼Œå°±å…³é—­æ–‡ä»¶ã€‚å…³é—­ HDF5 æ–‡ä»¶ä¼šä½¿æ•°æ®é›†å¤±æ•ˆï¼Œç„¶åè¯•å›¾è®¿é—® dset ä¼šæŠ›å‡ºä¸€
ä¸ªå¼‚å¸¸ã€‚
